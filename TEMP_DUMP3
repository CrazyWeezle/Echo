                        <line x1="6" y1="6" x2="18" y2="18" />
                      </svg>
                    </button>
                  </div>
                )}
                <textarea
                  ref={inputRef}
                  rows={1}
                  className="min-w-0 flex-1 px-3 py-3 text-base rounded bg-neutral-900 text-neutral-100 placeholder-neutral-500 outline-none focus:ring-2 focus:ring-emerald-600/60 border border-neutral-800/60 resize-none"
                  placeholder={`Message #${currentChannel?.name ?? 'general'}`}
                  value={text}
                  onChange={(e) => onInputChange(e.target.value)}
                  onPaste={onComposerPaste}
                  onKeyDown={(e) => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); send(); } }}
                  autoComplete="off"
                  autoCorrect="off"
                  autoCapitalize="sentences"
                  spellCheck={false}
                  name="chat-message"
                  data-lpignore="true"
                  data-1p-ignore
                  data-bw-ignore
                  data-form-type="other"
                />
                <button
                  className="shrink-0 px-2 md:px-3 py-2 rounded border border-emerald-700 bg-emerald-800/70 hover:bg-emerald-700/70 text-emerald-50 flex items-center justify-center"
                  onClick={send}
                >
                  <span className="md:hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="h-5 w-5">
                      <path d="M22 2L11 13"/>
                      <path d="M22 2l-7 20-4-9-9-4 20-7z"/>
                    </svg>
                  </span>
                  <span className="hidden md:inline">Send</span>
                </button>
              </div>
              {composerPickerOpen && (
                <Suspense>
                  <EmojiPanel
                    onClose={() => setComposerPickerOpen(false)}
                    onSelect={(native: string) => { addRecentEmoji(native); insertEmojiAtCaret(native); }}
                  />
                </Suspense>
              )}
            </>
          )}
        </div>
      )}

      {/* Close main content column */}
